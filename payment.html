<!DOCTYPE html>
<html>
<head>
<title>Payment</title>
<link rel="stylesheet" href="style.css">
</head>
<body onload="protect();loadPay()">

<nav>
<a href="dashboard.html">Dashboard</a>
<a href="#" onclick="logout()">Logout</a>
</nav>

<table id="pay">
<tr><th>Worker</th><th>Amount</th></tr>
</table>

<script src="auth.js"></script>
<script src="supabase.js"></script>
<script>
async function loadPay(){
 const {data}=await supabase
 .from("attendance")
 .select("status,workers(name,full_pay,half_pay)");

 pay.innerHTML=`<tr><th>Worker</th><th>Amount</th></tr>`;
 data.forEach(r=>{
  let amt=r.status==="full"?r.workers.full_pay:
          r.status==="half"?r.workers.half_pay:0;
  pay.innerHTML+=`<tr><td>${r.workers.name}</td><td>${amt}</td></tr>`;
 });
}
</script>
</body>
</html>
